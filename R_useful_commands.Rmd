---
title: "Useful Commands"
author: "Jaime Abraham Castro-Mondragon"
date: 'Last update: `r Sys.Date()`'
output: 
  html_document:
    number_sections: true
    theme: cosmo
    toc: true
    toc_depth: 4
    toc_float:
      collapsed: true
    self_contained: true
    code_folding: show
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(klippy)

# remotes::install_github("rlesur/klippy")
```

```{r functions, include=FALSE}
# ----------------------- #
# Show/Hide figure botton #
# ----------------------- #

insert.fig.toggle <- function(
  fig.id,        # Unique id for the div/button (e.g. "figVMWare")
  button.label,  # Label for the button (e.g. "Toggle Figure 1")
  img.src,       # Path to image (e.g. "fig/01_VMWare_login.png")
  fig.width = "45%",  # Width style for image
  fig.cap = "Caption text"  # Figure caption text
) {
  safe_fig_id <- gsub("'", "\\'", fig.id)
  safe_button_label <- gsub("'", "\\'", button.label)
  safe_img_src <- gsub("'", "\\'", img.src)
  safe_fig_cap <- gsub("'", "\\'", fig.cap)
  
  cat(sprintf('
<div style="margin-bottom: 10px; text-align: right;">
  <button class="btn-toggle" onclick="toggleFigure(\'%s\')">%s</button>
</div>
<div id="%s" style="display:block; text-align: center; margin-bottom: 20px;">
  <img src="%s" style="width:%s;" class="img-fluid"/>
  <p><strong>%s.</strong> %s</p>
</div>
', safe_fig_id, safe_button_label, safe_fig_id, safe_img_src, fig.width, safe_button_label, safe_fig_cap))
}
```

```{r klippy, echo=FALSE, include=TRUE}
klippy::klippy(lang     = c('r', 'python', 'bash'),
               position = c('top', 'right'),
               color    = '#253494')
```

<br>

# Introduction

<br>

In this document you will find many commands from `R`. I use these commands frequently and I think they are useful **but easy to forget**.

So, to avoid searching on the `bash history` or in google, it is better to have a repository with all of them, enjoy.

<br>

# `R`

<br>

## Generate a color palette with `N` colors using `rcartocolor`.

<br>

See all the available palettes [here](https://carto.com/carto-colors/).


```{r palette, echo=TRUE, eval=TRUE}

library(rcartocolor)

#' @description 
#' Create a color palette from rcartocolor with N colors.
#' Users can specify the number of seeds colors (default = 10)
#'
#' @param N An integer
#' @param rcc.palette A string.
#' @param seed.colors An integer
#' @return A vector with N Hex color codes
#' @examples
#' generate.color.palette(10)
generate.color.palette <- function(N           = 10,
                                   rcc.palette = "SunsetDark",
                                   seed.colors = 10) {
  
  ## Cluster colors
  nb.seed.colors <- ifelse(N < seed.colors,
                           yes = N,
                           no  = seed.colors)
  
  ## Generate a carto palette and expand it to the number of clusters
  carto.pal.classes <- carto_pal(nb.seed.colors, rcc.palette)
  class.colors      <- colorRampPalette(carto.pal.classes, space = "Lab")(N)
  
  return(class.colors)
}

# Examples
generate.color.palette(5)
generate.color.palette(10)
```

<br>

## Generate a `renv.lock` file using `renv`

<br>

This file is needed in `github actions` to manages dependencies and cache `R` packages.


```{r renv_lock, echo=TRUE, eval=FALSE}

library(renv)
library(rcartocolor)

# initialize a new project (with an empty R library)
renv::init(bare = TRUE)

# install digest 0.6.19
renv::install("digest@0.6.19")

# save library state to lockfile
renv::snapshot()

# remove digest from library
renv::remove("digest")

# check library status
renv::status()

# restore lockfile, thereby reinstalling digest 0.6.19
renv::restore()


#  Control dependencies : https://rstudio.github.io/renv/reference/snapshot.html
renv::settings$snapshot.type("explicit")
```

<br>



```{r toggle, echo=FALSE, results='asis'}

cat('
<style>
.btn-toggle {
  background-color: #0275d8;
  border: none;
  color: white;
  padding: 8px 16px;
  font-size: 14px;
  border-radius: 12px;       /* Rounded corners */
  cursor: pointer;
  transition: background-color 0.3s ease;
  box-shadow: 0 2px 4px rgba(0,0,0,0.15);
}
.btn-toggle:hover {
  background-color: #025aa5;
}
</style>

<script>
function toggleFigure(id) {
  var fig = document.getElementById(id);
  if (fig.style.display === "none" || fig.style.display === "") {
    fig.style.display = "block";
  } else {
    fig.style.display = "none";
  }
}
</script>
')
```